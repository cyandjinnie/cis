Примерно все описал в файлике .ipynb
